{% extends 'base.html' %}
{% block title %}Products - Inventory System{% endblock %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="page-title"><i class="fas fa-box"></i> Products</h1>
    <a href="{% url 'add_product' %}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Product
    </a>
</div>

<div class="card mb-4">
    <div class="card-header bg-light">
        <h5 class="mb-0"><i class="fas fa-search"></i> Filter Products</h5>
    </div>
    <div class="card-body">
        <form method="get" class="row g-3">
            <div class="col-md-6 col-lg-5">
                <input type="text" name="q" class="form-control" placeholder="Search by product name..."
                    value="{{ query }}">
            </div>
            <div class="col-md-4 col-lg-5">
                <select name="category" class="form-select">
                    <option value="">All Categories</option>
                   {% for cat in categories %}
    {% with cat_id=cat.id|stringformat:"s" %}
        <option value="{{ cat.id }}" {% if cat_id == selected_category %}selected{% endif %}>
            {{ cat.name }}
        </option>
    {% endwith %}
{% endfor %}
                </select>
            </div>
            <div class="col-md-2 col-lg-2">
                <button type="submit" class="btn btn-primary w-100"><i class="fas fa-search"></i> Filter</button>
            </div>
        </form>
    </div>
</div>

{% if products %}
<div class="table-responsive">
    <table class="table table-hover table-striped">
        <thead style="background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%); color: white;">
            <tr>
                <th><i class="fas fa-box"></i> Product Name</th>
                <th><i class="fas fa-tag"></i> Category</th>
                <th><i class="fas fa-truck"></i> Supplier</th>
                <th><i class="fas fa-dollar-sign"></i> Price</th>
                <th><i class="fas fa-warehouse"></i> Qty</th>
                <th><i class="fas fa-flag"></i> Reorder</th>
                <th><i class="fas fa-signal"></i> Status</th>
                <th><i class="fas fa-cogs"></i> Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>
                    <a href="{% url 'product_detail' product.id %}" class="text-decoration-none fw-bold">
                        {{ product.name }}
                    </a>
                </td>
                <td><span class="badge bg-light text-dark">{{ product.category.name }}</span></td>
                <td>{{ product.supplier.name }}</td>
                <td><span class="fw-bold">${{ product.price }}</span></td>
                <td><span class="badge bg-secondary">{{ product.quantity }}</span></td>
                <td>{{ product.reorder_level }}</td>
                <td>
                    {% if product.is_low_stock %}
                    <span class="badge bg-danger"><i class="fas fa-exclamation"></i> Low Stock</span>
                    {% else %}
                    <span class="badge bg-success"><i class="fas fa-check"></i> In Stock</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'edit_product' product.id %}" class="btn btn-sm btn-warning" title="Edit"><i
                            class="fas fa-edit"></i></a>
                    <a href="{% url 'delete_product' product.id %}" class="btn btn-sm btn-danger" title="Delete"><i
                            class="fas fa-trash"></i></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<style>
    @media (max-width: 768px) {
        .table-responsive {
            font-size: 0.875rem;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }
    }
</style>
{% else %}
<div class="alert alert-info border-0">
    <i class="fas fa-info-circle"></i> No products found. <a href="{% url 'add_product' %}" class="alert-link">Add one
        now!</a>
</div>
{% endif %}
{% endblock %}
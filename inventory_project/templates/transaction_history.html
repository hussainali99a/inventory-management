{% extends 'base.html' %}
{% block title %}Transaction History - Inventory System{% endblock %}
{% block content %}

<div class="row mb-4">
    <div class="col-12">
        <h1 class="page-title"><i class="fas fa-exchange-alt"></i> Transaction History</h1>
    </div>
</div>

<div class="card shadow-lg mb-4">
    <div class="card-header" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
        <h5 class="mb-0 text-white"><i class="fas fa-filter"></i> Filter Transactions</h5>
    </div>
    <div class="card-body">
        <form method="get" class="row g-3">
            <div class="col-md-8">
                <select name="product" class="form-select form-select-lg">
                    <option value="">All Products</option>
                    {% for prod in products %}
                    {% with prod_id=prod.id|stringformat:"s" %}
                    <option value="{{ prod.id }}" {% if prod_id == selected_product %}selected{% endif %}>
                        {{ prod.name }}
                    </option>
                    {% endwith %}
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4">
                <button type="submit" class="btn btn-info w-100 h-100">
                    <i class="fas fa-search me-2"></i> Filter
                </button>
            </div>
        </form>
    </div>
</div>

{% if transactions %}
<div class="card shadow-lg">
    <div class="card-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
        <h5 class="mb-0 text-white"><i class="fas fa-history"></i> Recent Transactions</h5>
    </div>
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead class="table-light">
                <tr>
                    <th><i class="fas fa-calendar"></i> Date & Time</th>
                    <th><i class="fas fa-box"></i> Product</th>
                    <th><i class="fas fa-arrow-right-arrow-left"></i> Type</th>
                    <th><i class="fas fa-cubes"></i> Quantity</th>
                    <th><i class="fas fa-user"></i> Performed By</th>
                </tr>
            </thead>
            <tbody>
                {% for transaction in transactions %}
                <tr>
                    <td>
                        <small class="text-muted">
                            <i class="fas fa-clock"></i> {{ transaction.date|date:"M d, Y H:i:s" }}
                        </small>
                    </td>
                    <td>
                        <a href="{% url 'product_detail' transaction.product.id %}"
                            class="text-decoration-none fw-bold">
                            {{ transaction.product.name }}
                        </a>
                    </td>
                    <td>
                        {% if transaction.transaction_type == 'IN' %}
                        <span class="badge bg-success"><i class="fas fa-arrow-down"></i> Stock In</span>
                        {% else %}
                        <span class="badge bg-danger"><i class="fas fa-arrow-up"></i> Stock Out</span>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge bg-secondary fs-6">{{ transaction.quantity }}</span>
                    </td>
                    <td>
                        <span class="badge bg-light text-dark">
                            <i class="fas fa-user-circle"></i> {{ transaction.performed_by.username }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="alert alert-info border-0 shadow-sm">
    <i class="fas fa-info-circle me-2"></i>
    No transactions found.
</div>
{% endif %}

<style>
    .card {
        border: none;
        border-radius: 0.75rem;
    }

    .table {
        font-size: 0.95rem;
    }

    .badge {
        padding: 0.5rem 0.75rem;
    }

    @media (max-width: 768px) {
        .page-title {
            font-size: 1.5rem;
        }

        .table-responsive {
            font-size: 0.85rem;
        }

        .table th,
        .table td {
            padding: 0.5rem;
        }
    }
</style>

{% endblock %}